# iOSショートカット連携設定ガイド

このガイドでは、Muscle TrackerアプリとiOSショートカットを連携させて、バックグラウンドでタイマーを動作させる方法を説明します。

## 📱 概要

ショートカット連携を有効にすると：
- セット記録時に自動的にiOSショートカットが起動
- 2分のタイマーが開始
- タイマー終了時にシステム通知が表示
- 自動的にWebアプリに戻る
- ワークアウトデータは継続して記録される

## 🔧 設定手順

### 1. iOSショートカットを作成

1. **ショートカットアプリを開く**
   - iPhoneの「ショートカット」アプリを起動

2. **新規ショートカットを作成**
   - 右上の「+」ボタンをタップ
   - 「アクションを追加」をタップ

3. **アクションを追加**（以下の順番で追加）

   **① タイマーを開始**
   - 検索バーで「タイマー」と検索
   - 「タイマーを開始」アクションを追加
   - 時間を「2分0秒」に設定

   **② 待機**
   - 検索バーで「待機」と検索
   - 「待機」アクションを追加
   - 時間を「2分0秒」に設定

   **③ 通知を表示**
   - 検索バーで「通知」と検索
   - 「通知を表示」アクションを追加
   - タイトル: 「インターバル終了！」
   - 本文: 「次のセットを開始してください」
   - サウンド: オン

   **④ URLを開く**
   - 検索バーで「URL」と検索
   - 「URLを開く」アクションを追加
   - URL: あなたのアプリのURL（例: `https://muscle-tracker-xxx.vercel.app`）

4. **ショートカット名を設定**
   - 上部のショートカット名をタップ
   - 名前を「筋トレタイマー」に変更（**重要**: この名前を正確に設定してください）
   - 「完了」をタップ

### 2. Webアプリで連携を有効化

1. **Muscle Trackerアプリを開く**
   - ブラウザでアプリにアクセス

2. **トレーニングを開始**
   - 「▶ トレーニング開始」ボタンをタップ

3. **ショートカット連携を有効化**
   - 「ショートカットタイマー」のトグルをオンにする
   - トグルが緑色になれば有効化完了

### 3. 動作確認

1. **セットを記録**
   - 重量と回数を入力
   - 「セット記録」ボタンをタップ

2. **ショートカットが起動**
   - 自動的にショートカットアプリが開く
   - 2分のタイマーが開始
   - すぐにWebアプリに戻る

3. **2分後**
   - システム通知が表示される
   - 自動的にWebアプリに戻る

4. **トレーニングを継続**
   - ワークアウトデータは継続して記録されている
   - 次のセットを開始

## ⚙️ カスタマイズ

### タイマー時間を変更

ショートカットの「タイマーを開始」と「待機」の時間を変更することで、インターバル時間をカスタマイズできます。

例：
- 1分30秒: 「1分30秒」に変更
- 3分: 「3分0秒」に変更

### 通知内容を変更

ショートカットの「通知を表示」アクションで、通知のタイトルや本文を自由に変更できます。

## 🔍 トラブルシューティング

### ショートカットが起動しない

**原因**: ショートカット名が正しくない

**解決策**:
- ショートカット名が「筋トレタイマー」になっているか確認
- 全角・半角、スペースなどが正確に一致しているか確認

### Webアプリに戻らない

**原因**: URLが正しくない

**解決策**:
- ショートカットの「URLを開く」アクションで、正しいアプリのURLを設定
- Vercelのデプロイ後のURLを確認して設定

### データが消える

**原因**: ブラウザのキャッシュがクリアされた

**解決策**:
- ワークアウトデータはlocalStorageに保存されています
- ブラウザのキャッシュをクリアしないように注意
- 「終了」ボタンを押すまでデータは保持されます

### 通知が表示されない

**原因**: 通知権限が許可されていない

**解決策**:
- iPhoneの「設定」→「通知」→「ショートカット」
- 通知を許可する

## 💡 ヒント

- **バックグラウンドで動作**: ショートカットはバックグラウンドで動作するため、他のアプリを使用していてもタイマーは正確に動作します
- **バッテリー消費**: ショートカットのタイマーはシステムレベルで動作するため、バッテリー消費は最小限です
- **複数のショートカット**: 異なるインターバル時間用に複数のショートカットを作成することもできます（例: 「筋トレタイマー1分」「筋トレタイマー3分」）

## 📝 注意事項

- この機能はiOS専用です（Androidでは動作しません）
- ショートカット連携を無効にすると、通常のWebアプリ内タイマーが使用されます
- ワークアウトデータは「終了」ボタンを押すまでlocalStorageに保存されます
- ブラウザを完全に閉じてもデータは保持されます

## 🎉 完了

これで、iOSショートカットとの連携が完了しました！
トレーニング中にアプリを閉じても、正確なタイマーと通知が機能します。

良いトレーニングを！💪
